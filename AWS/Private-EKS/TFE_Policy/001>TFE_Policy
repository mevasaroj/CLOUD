{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "FullAccess",
            "Effect": "Allow",
            "Action": [
                "acm:DescribeCertificate",
                "acm:Get*",
                "acm:List*",
                "lambda:AddLayerVersionPermission",
                "lambda:Create*",
                "lambda:Get*",
                "lambda:Invoke*",
                "lambda:List*",
                "lambda:Put*",
                "lambda:TagResource",
                "lambda:UntagResource",
                "lambda:Update*",
                "lambda:DeleteFunction",
                "rds:Add*",
                "rds:AuthorizeDBSecurityGroupIngress",
                "rds:Copy*",
                "rds:Create*",
                "rds:Delete*",
                "rds:Describe*",
                "rds:FailoverDBCluster",
                "rds:ListTagsForResource",
                "rds:Modify*",
                "rds:Reboot*",
                "rds:Remove*",
                "rds:Reset*",
                "rds:Restore*",
                "rds:Start*",
                "rds:Stop*",
                "rds:SwitchoverReadReplica",
                "s3:Create*",
                "s3:Delete*",
                "s3:Describe*",
                "s3:Get*",
                "s3:List*",
                "s3:Put*",
                "s3:Restore*",
                "s3:Update*",
                "secretsmanager:List*",
                "secretsmanager:Describe*",
                "secretsmanager:Get*",
                "secretsmanager:Create*",
                "secretsmanager:Put*",
                "secretsmanager:Restore*",
                "secretsmanager:Rotate*",
                "secretsmanager:Update*",
                "secretsmanager:Delete*",
                "secretsmanager:Replicate*",
                "secretsmanager:Stop*",
                "secretsmanager:TagResource",
                "secretsmanager:UntagResource",
                "ssmmessages:Create*",
                "ssmmessages:Open*",
                "sts:DecodeAuthorizationMessage",
                "tag:DescribeReportCreation",
                "tag:Get*",
                "tag:StartReportCreation",
                "tag:TagResources",
                "tag:UntagResources"
            ],
            "Resource": "*"
        },
        {
            "Sid": "KMSAccess",
            "Effect": "Allow",
            "Action": [
                "kms:ListGrants",
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey",
                "kms:GenerateDataKeyWithoutPlaintext",
                "kms:DescribeKey",
                "kms:CreateGrant",
                "kms:ListAliases",
                "kms:TagResource"
            ],
            "Resource": [
                "arn:aws:kms:ap-south-1:911372318716:key/1e884af2-73cd-4132-9612-d9dd72d981e0",
                "arn:aws:kms:ap-south-1:911372318716:key/mrk-62981b3189ca460facce77ff358971cc"
            ]
        },
        {
            "Sid": "AllowServiceLinkRoleCreation",
            "Effect": "Allow",
            "Action": "iam:CreateServiceLinkedRole",
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "iam:AWSServiceName": [
                        "autoscaling.amazonaws.com",
                        "ec2scheduled.amazonaws.com",
                        "elasticloadbalancing.amazonaws.com",
                        "eks.amazonaws.com",
                        "eks-fargate-pods.amazonaws.com",
                        "eks-nodegroup.amazonaws.com",
                        "spot.amazonaws.com",
                        "spotfleet.amazonaws.com",
                        "transitgateway.amazonaws.com",
                        "rds.application-autoscaling.amazonaws.com",
                        "rds.amazonaws.com",
                        "acm.amazonaws.com",
                        "ssm.amazonaws.com",
                        "elasticache.amazonaws.com",
                        "replication.dynamodb.amazonaws.com",
                        "dynamodb.application-autoscaling.amazonaws.com",
                        "contributorinsights.dynamodb.amazonaws.com",
                        "kinesisreplication.dynamodb.amazonaws.com",
                        "elasticfilesystem.amazonaws.com",
                        "globalaccelerator.amazonaws.com",
                        "mq.amazonaws.com",
                        "kafka.amazonaws.com",
                        "glue.amazonaws.com",
                        "lambda.amazonaws.com",
                        "events.amazonaws.com",
                        "memorydb.amazonaws.com"
                    ]
                }
            }
        },
        {
            "Sid": "BedrockAccess",
            "Effect": "Allow",
            "Action": [
                "cloudformation:CreateResource"
            ],
            "Resource": "*"
        },
        {
            "Sid": "IAMPassRole",
            "Effect": "Allow",
            "Resource": "*",
            "Action": "iam:PassRole",
            "Condition": {
                "StringLike": {
                    "iam:PassedToService": [
                        "acm.amazonaws.com",
                        "application-autoscaling.amazonaws.com",
                        "application-autoscaling.amazonaws.com.cn",
                        "autoscaling.amazonaws.com",
                        "contributorinsights.dynamodb.amazonaws.com",
                        "cloudwatch.amazonaws.com",
                        "dynamodb.application-autoscaling.amazonaws.com",
                        "ec2.amazonaws.com",
                        "ec2scheduled.amazonaws.com",
                        "elasticloadbalancing.amazonaws.com",
                        "eks.amazonaws.com",
                        "eks-fargate-pods.amazonaws.com",
                        "eks-nodegroup.amazonaws.com",
                        "es.amazonaws.com",
                        "elasticache.amazonaws.com",
                        "spot.amazonaws.com",
                        "spotfleet.amazonaws.com",
                        "transitgateway.amazonaws.com",
                        "rds.application-autoscaling.amazonaws.com",
                        "rds.amazonaws.com",
                        "ssm.amazonaws.com",
                        "replication.dynamodb.amazonaws.com",
                        "kinesisreplication.dynamodb.amazonaws.com",
                        "elasticfilesystem.amazonaws.com",
                        "globalaccelerator.amazonaws.com",
                        "mq.amazonaws.com",
                        "kafka.amazonaws.com",
                        "lambda.amazonaws.com",
                        "glue.amazonaws.com",
                        "events.amazonaws.com",
                        "memorydb.amazonaws.com"
                    ]
                }
            }
        },
        {
            "Sid": "IAMOIDCAccess",
            "Effect": "Allow",
            "Action": [
                "iam:CreateOpenIDConnectProvider",
                "iam:DeleteOpenIDConnectProvider",
                "iam:UpdateOpenIDConnectProviderThumbprint"
            ],
            "Resource": "*"
        },
        {
            "Sid": "IAMLimitAccess",
            "Effect": "Allow",
            "Action": [
                "iam:Generate*",
                "iam:Get*",
                "iam:List*",
                "iam:Tag*",
                "iam:Untag*",
                "iam:Put*",
                "iam:DeleteInstanceProfile",
                "iam:RemoveRoleFromInstanceProfile",
                "iam:AttachRolePolicy",
                "iam:AddRoleToInstanceProfile",
                "iam:DeleteServiceLinkedRole"
            ],
            "Resource": "*"
        },
        {
            "Sid": "LocalAccountAWSManageKMSAccess",
            "Effect": "Allow",
            "Action": "kms:DescribeKey",
            "Resource": "arn:aws:kms:ap-south-1:216066832707:key/7a4424ed-384a-4e04-80ec-03f30fcf5ee5"
        },
        {
            "Effect": "Allow",
            "Action": [
                "iam:DeleteServiceLinkedRole",
                "iam:GetServiceLinkedRoleDeletionStatus"
            ],
            "Resource": [
                "arn:aws:iam::*:role/aws-service-role/acm.amazonaws.com/AWSServiceRoleForCertificateManager*",
                "arn:aws:iam::*:role/aws-service-role/ssm.amazonaws.com/AWSServiceRoleForAmazonSSM*"
            ]
        },
        {
            "Sid": "DenySecurityGroupModification",
            "Effect": "Deny",
            "Action": [
                "ec2:ModifySecurityGroupRules",
                "ec2:CreateSecurityGroup"
            ],
            "Resource": "*"
        },
        {
            "Sid": "RequireIMDSv2",
            "Effect": "Deny",
            "Action": "ec2:RunInstances",
            "Resource": "arn:aws:ec2:*:*:instance/*",
            "Condition": {
                "StringNotEquals": {
                    "ec2:MetadataHttpTokens": "required",
                    "ec2:VolumeType": "gp3"
                }
            }
        },
        {
            "Sid": "VolumeType",
            "Effect": "Deny",
            "Action": "ec2:*",
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "ec2:VolumeType": [
                        "gp2",
                        "io1",
                        "io2",
                        "sc1",
                        "st1"
                    ]
                }
            }
        }
    ]
}
